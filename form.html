<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questionário para Análise de Ação Trabalhista</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: auto;
        }
        h1, h2 {
            color: #0056b3;
            text-align: center;
            margin-bottom: 20px;
        }
        h3 {
            color: #0056b3;
            margin-top: 30px;
            margin-bottom: 15px;
            border-bottom: 2px solid #e2f0ff;
            padding-bottom: 5px;
        }
        .question-group {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            background-color: #fcfcfc;
        }
        .question-group strong {
            display: block;
            margin-bottom: 10px;
            color: #004085;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"],
        input[type="date"],
        input[type="email"],
        input[type="tel"],
        textarea {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 1rem;
        }
        textarea {
            min-height: 80px;
            resize: vertical;
        }
        .notes {
            font-size: 0.9em;
            color: #777;
            margin-top: -10px;
            margin-bottom: 10px;
            padding-left: 5px;
        }
        .action-buttons-container {
            text-align: center;
            margin-top: 30px;
            min-height: 60px;
        }
        .action-button {
            background-color: #007bff;
            color: white;
            padding: 15px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: background-color 0.3s ease;
        }
        .action-button:hover {
            background-color: #0056b3;
        }
        .instructions-box {
            background-color: #e2f0ff;
            border: 1px solid #cce5ff;
            padding: 20px;
            margin-top: 25px;
            border-radius: 8px;
            font-size: 1.1em;
            color: #004085;
        }
        #successMessage {
            color: #28a745;
            font-weight: bold;
            margin-top: 15px;
            text-align: center;
            display: none;
        }

        /* Estilos para o PDF - ESTRUTURA ÚNICA SEM DUPLICAÇÃO */
        .pdf-container {
            position: absolute;
            left: -9999px;
            top: -9999px;
            width: 800px;
            background: white;
            padding: 30px;
            font-family: Arial, sans-serif;
            line-height: 1.5;
            color: #333;
        }
        .pdf-title {
            color: #0056b3;
            text-align: center;
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 30px;
        }
        .pdf-section {
            margin-bottom: 25px;
            page-break-inside: avoid;
        }
        .pdf-section h3 {
            color: #0056b3;
            border-bottom: 2px solid #0056b3;
            padding-bottom: 5px;
            margin-bottom: 15px;
            font-size: 18px;
        }
        .pdf-question {
            margin-bottom: 15px;
            page-break-inside: avoid;
        }
        .pdf-question .question {
            font-weight: bold;
            color: #004085;
            margin-bottom: 5px;
        }
        .pdf-question .answer {
            border-bottom: 1px solid #ccc;
            padding: 5px 0;
            min-height: 20px;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Questionário para Análise de Ação Trabalhista</h1>
        <h2>Preencha os campos abaixo com as informações solicitadas para que possamos analisar sua situação e quantificar seus direitos trabalhistas.</h2>
        <p style="text-align: center; font-style: italic; color: #666;">Ao finalizar, clique no botão abaixo para gerar e baixar o PDF com suas respostas.</p>

        <form id="questionarioForm">
            <h3>I. Dados Pessoais e Contrato de Trabalho</h3>
            <div class="question-group">
                <strong>Dados do Trabalhador:</strong>
                <label for="nome_completo">Nome completo:</label>
                <input type="text" id="nome_completo" name="Nome Completo" required>
                
                <label for="cpf">CPF:</label>
                <input type="text" id="cpf" name="CPF" required>
                
                <label for="rg">RG:</label>
                <input type="text" id="rg" name="RG">
                
                <label for="data_nascimento">Data de Nascimento:</label>
                <input type="date" id="data_nascimento" name="Data de Nascimento">
                
                <label for="endereco">Endereço completo (Rua, Número, Bairro, Cidade, Estado, CEP):</label>
                <textarea id="endereco" name="Endereço Completo"></textarea>
                
                <label for="telefone">Telefone:</label>
                <input type="tel" id="telefone" name="Telefone" required>
                
                <label for="email_cliente">E-mail:</label>
                <input type="email" id="email_cliente" name="Email do Cliente" required>
                
                <div class="notes">Para qualificação da ação e contato.</div>
            </div>

            <div class="question-group">
                <strong>Dados da Empresa (Empregadora):</strong>
                <label for="razao_social">Nome completo (razão social) da empresa:</label>
                <input type="text" id="razao_social" name="Razão Social da Empresa" required>
                
                <label for="cnpj">CNPJ da empresa:</label>
                <input type="text" id="cnpj" name="CNPJ da Empresa">
                
                <label for="endereco_empresa">Endereço completo da empresa:</label>
                <textarea id="endereco_empresa" name="Endereço da Empresa"></textarea>
                
                <label for="responsavel_empresa">Nome do responsável da empresa (RH/Sócio, se souber):</label>
                <input type="text" id="responsavel_empresa" name="Responsável da Empresa">
                
                <div class="notes">Para qualificação da ação e notificação.</div>
            </div>

            <div class="question-group">
                <strong>Contrato de Trabalho:</strong>
                <label for="copia_contrato">Você possui cópia do contrato de trabalho (se houver)?</label>
                <input type="text" id="copia_contrato" name="Cópia Contrato Trabalho" placeholder="Sim / Não / Parcialmente">
                
                <label for="data_inicio">Data de início da sua prestação de serviços (dia/mês/ano):</label>
                <input type="date" id="data_inicio" name="Data de Início">
                
                <label for="data_saida">Data de saída (se já ocorreu) (dia/mês/ano):</label>
                <input type="date" id="data_saida" name="Data de Saída">
                
                <label for="cargo_funcao">Qual era seu cargo/função registrada no contrato de trabalho?</label>
                <input type="text" id="cargo_funcao" name="Cargo/Função Contratada">
                
                <label for="salario_inicial">Qual era o seu salário inicial e quais foram os últimos salários recebidos? Por favor, discrimine o valor nominal e o valor total com adicionais, se houver:</label>
                <textarea id="salario_inicial" name="Salários Recebidos"></textarea>
                
                <div class="notes">Essencial para verificar a relação empregatícia, tempo de serviço e base de cálculo para verbas.</div>
            </div>

            <div class="question-group">
                <strong>Registro em CTPS (Carteira de Trabalho e Previdência Social):</strong>
                <label for="copia_ctps">Você possui cópia da sua CTPS (página da foto, qualificação civil, contrato de trabalho, anotações de férias, aumentos salariais)?</label>
                <input type="text" id="copia_ctps" name="Cópia CTPS" placeholder="Sim / Não / Parcialmente">
                
                <div class="notes">Para comprovar o vínculo, data de início, função e salários. Verificar se há divergências.</div>
            </div>

            <h3>II. Jornada de Trabalho</h3>
            <div class="question-group">
                <label for="carga_horaria_contratual">Qual a carga horária estabelecida no seu contrato de trabalho (ex: 8h/dia, 44h/semana)?</label>
                <input type="text" id="carga_horaria_contratual" name="Carga Horária Contratual">
                <div class="notes">Base para identificar horas extras.</div>
            </div>

            <div class="question-group">
                <label for="jornada_praticada">Descreva detalhadamente a sua jornada de trabalho diária efetivamente praticada (horário de entrada, saída, tempo e horário de intervalo para almoço/descanso):</label>
                <textarea id="jornada_praticada" name="Jornada Praticada" placeholder="Ex: De segunda a sexta, das 8h às 18h, com 30min de intervalo das 12h às 12h30. Sábados das 8h às 12h."></textarea>
                <div class="notes">Essencial para calcular horas extras, intrajornada, etc.</div>
            </div>

            <div class="question-group">
                <label for="qtd_horas_extras">Quantas horas extras você estima ter feito por dia/semana/mês?</label>
                <input type="text" id="qtd_horas_extras" name="Quantidade Horas Extras Estimada">
                
                <label for="registro_ponto">A empresa mantinha registro de ponto (cartões de ponto, folha de ponto, sistema digital, etc.)? Se sim, você possui cópias?</label>
                <input type="text" id="registro_ponto" name="Registro Ponto Existe?" placeholder="Sim / Não / Parcialmente">
                
                <div class="notes">Para comprovar o labor extraordinário. Se não houver registro, outros meios de prova serão necessários (testemunhas, e-mails, mensagens).</div>
            </div>

            <div class="question-group">
                <label for="pagamento_horas_extras">As horas extras eram pagas? Se sim, elas constavam no seu contracheque ou eram pagas "por fora"? Qual o valor pago (se souber)?</label>
                <textarea id="pagamento_horas_extras" name="Pagamento Horas Extras"></textarea>
                <div class="notes">Verificar a regularidade do pagamento e a existência de pagamento "por fora".</div>
            </div>

            <div class="question-group">
                <label for="duracao_intervalo">Qual a duração do seu intervalo para almoço/descanso? Era gozado integralmente ou era interrompido/reduzido?</label>
                <textarea id="duracao_intervalo" name="Duração Intervalo Intrajornada"></textarea>
                <div class="notes">Verificar supressão ou concessão parcial do intervalo (art. 71, CLT).</div>
            </div>

            <div class="question-group">
                <label for="dsr">Você tinha folga semanal (Descanso Semanal Remunerado - DSR)? Quantas por semana? Era sempre no mesmo dia? Houve trabalho em DSR ou feriados? Se sim, esses dias foram pagos em dobro?</label>
                <textarea id="dsr" name="DSR e Feriados Trabalhados"></textarea>
                <div class="notes">Verificar o gozo do DSR e o pagamento correto de feriados trabalhados.</div>
            </div>

            <h3>III. Salário e Verbas Trabalhistas</h3>
            <div class="question-group">
                <label for="copia_contracheques">Você possui cópias de todos os seus contracheques/holerites desde o início do contrato?</label>
                <input type="text" id="copia_contracheques" name="Cópia Contracheques" placeholder="Sim / Não / Parcialmente">
                <div class="notes">Prova fundamental para comprovar salários pagos, descontos, adicionais e o não pagamento de verbas.</div>
            </div>

            <div class="question-group">
                <label for="adicionais">Você recebia algum adicional (noturno, periculosidade, insalubridade)? Se sim, era pago corretamente e em qual percentual?</label>
                <textarea id="adicionais" name="Adicionais Recebidos"></textarea>
                <div class="notes">Verificar o direito a adicionais e se o pagamento era devido e correto.</div>
            </div>

            <div class="question-group">
                <label for="desvio_funcao">Detalhe as funções para as quais você foi contratado e as funções que efetivamente exercia. Descreva as novas funções e quando elas começaram. (Ex: "Fui contratado como motorista de carro pequeno, mas desde [mês/ano] passei a dirigir ônibus grande sem alteração de contrato ou salário")</label>
                <textarea id="desvio_funcao" name="Desvio/Acúmulo de Função" rows="6"></textarea>
                <div class="notes">Para comprovar o desvio ou acúmulo e fundamentar o pedido de diferenças salariais ou equiparação.</div>
            </div>

            <div class="question-group">
                <label for="reajustes_salariais">Houve reajustes salariais durante o contrato? Se sim, quais as datas e valores de cada reajuste?</label>
                <textarea id="reajustes_salariais" name="Reajustes Salariais"></textarea>
                <div class="notes">Verificar se os reajustes foram aplicados conforme a legislação ou acordos/convenções coletivas.</div>
            </div>

            <div class="question-group">
                <label for="beneficios">Quais benefícios a empresa oferecia (vale-transporte, vale-alimentação/refeição, plano de saúde, outros)? Como eles eram concedidos (pagos, descontados)? (Ex: "Recebia vale-alimentação, mas o valor era menor do que o prometido e era 'descontado como carro'")</label>
                <textarea id="beneficios" name="Benefícios Recebidos"></textarea>
                <div class="notes">Verificar a regularidade dos benefícios e possíveis irregularidades.</div>
            </div>

            <div class="question-group">
                <label for="fgts">Os depósitos de FGTS foram feitos regularmente? Você possui extrato do FGTS?</label>
                <input type="text" id="fgts" name="Depósitos FGTS" placeholder="Sim / Não / Não sei / Parcialmente">
                <div class="notes">Verificar a regularidade dos depósitos.</div>
            </div>

            <h3>IV. Rescisão Contratual (se aplicável)</h3>
            <div class="question-group">
                <label for="tipo_rescisao">Se o contrato já foi encerrado, qual o tipo de rescisão (sem justa causa, com justa causa, pedido de demissão, fim de contrato por prazo determinado, etc.)?</label>
                <input type="text" id="tipo_rescisao" name="Tipo de Rescisão">
                <div class="notes">Para verificar as verbas rescisórias devidas.</div>
            </div>

            <div class="question-group">
                <label for="trct">Você possui cópia do Termo de Rescisão de Contrato de Trabalho (TRCT) e comprovante de pagamento das verbas rescisórias?</label>
                <input type="text" id="trct" name="Cópia TRCT" placeholder="Sim / Não / Parcialmente">
                <div class="notes">Para verificar o que foi pago na rescisão e o que ficou pendente.</div>
            </div>

            <div class="question-group">
                <label for="seguro_desemprego">A empresa forneceu a guia do seguro-desemprego?</label>
                <input type="text" id="seguro_desemprego" name="Guia Seguro-Desemprego" placeholder="Sim / Não / Não tinha direito">
                <div class="notes">Verificar o direito e a habilitação ao seguro-desemprego.</div>
            </div>

            <h3>V. Assédio Moral/Perseguição</h3>
            <div class="question-group">
                <label for="detalhes_assedio">Descreva detalhadamente os episódios de perseguição/assédio: datas (mesmo que aproximadas), locais, quem estava envolvido (agressor e testemunhas), o que foi dito ou feito, e quais foram as consequências para você.</label>
                <textarea id="detalhes_assedio" name="Detalhes Assédio/Perseguição" rows="8"></textarea>
                <div class="notes">Para fundamentar o pedido de indenização por danos morais. Seja o mais específico possível.</div>
            </div>

            <div class="question-group">
                <label for="provas_assedio">Você possui provas desses incidentes (e-mails, mensagens, gravações, fotos, vídeos, atestados médicos, relatos de outras pessoas)? Por favor, liste quais.</label>
                <textarea id="provas_assedio" name="Provas Assédio/Perseguição"></textarea>
                <div class="notes">Essencial para comprovar o assédio.</div>
            </div>

            <div class="question-group">
                <label for="impacto_saude">O assédio ou a situação no trabalho causou algum impacto na sua saúde física ou mental (estresse, ansiedade, depressão, etc.)? Você possui laudos médicos, atestados ou faz tratamento psicológico/psiquiátrico?</label>
                <textarea id="impacto_saude" name="Impacto na Saúde (Assédio)"></textarea>
                <div class="notes">Para corroborar o pedido de danos morais e, eventualmente, pensão por danos materiais (se houver afastamento).</div>
            </div>

            <h3>VI. Provas e Testemunhas</h3>
            <div class="question-group">
                <label for="documentos_gerais">Você possui qualquer outro documento que possa ser útil (comprovantes de pagamento diversos, avisos, comunicados da empresa, etc.)?</label>
                <textarea id="documentos_gerais" name="Documentos Gerais Adicionais"></textarea>
                <div class="notes">Qualquer documento pode ser útil, mesmo que pareça insignificante.</div>
            </div>

            <div class="question-group">
                <label for="testemunhas">Você tem nomes, contatos e breve descrição do que cada testemunha presenciou? (Pessoas que trabalharam com você e viram as situações, familiares, amigos, etc.)</label>
                <textarea id="testemunhas" name="Testemunhas (Nomes e Contatos)" rows="6"></textarea>
                <div class="notes">Essencial para comprovar fatos alegados, especialmente horas extras, desvio de função e assédio.</div>
            </div>

            <div class="question-group">
                <label for="conversas_prints">Você possui prints de conversas de WhatsApp, e-mails, SMS ou outros registros digitais que comprovem a situação (ex: cobrança excessiva, reclamação de horas, alteração de função, mensagens do RH)?</label>
                <textarea id="conversas_prints" name="Conversas/Prints"></textarea>
                <div class="notes">Podem servir como indícios ou provas robustas.</div>
            </div>

            <h3>VII. Outras Informações Relevantes</h3>
            <div class="question-group">
                <label for="situacao_atual_cliente">Você ainda está trabalhando na empresa? Se sim, como está a situação atualmente?</label>
                <input type="text" id="situacao_atual_cliente" name="Situação Atual do Cliente">
                <div class="notes">Para avaliar a urgência da medida ou se há risco de dispensa.</div>
            </div>

            <div class="question-group">
                <label for="reclamacoes_anteriores">Você já reclamou formalmente à empresa sobre essas questões (RH, gerente, superior)? Houve alguma reunião ou tentativa de solução interna?</label>
                <textarea id="reclamacoes_anteriores" name="Reclamações Anteriores à Empresa"></textarea>
                <div class="notes">Para verificar se a empresa estava ciente e se houve inércia.</div>
            </div>

            <div class="question-group">
                <label for="conhecimento_empresa">O RH ou a gerência tinham conhecimento das irregularidades que você descreveu?</label>
                <input type="text" id="conhecimento_empresa" name="Conhecimento Empresa Irregularidades" placeholder="Sim / Não / Parcialmente">
                <div class="notes">Para verificar a responsabilidade da empresa.</div>
            </div>

            <div class="question-group">
                <label for="sindicato">Você é filiado a algum sindicato? O sindicato foi procurado para mediação ou orientação?</label>
                <input type="text" id="sindicato" name="Filiado Sindicato?" placeholder="Sim / Não / Não procurei">
                <div class="notes">O sindicato pode ter informações sobre acordos/convenções coletivas e auxiliar na mediação.</div>
            </div>
        </form>

        <div class="action-buttons-container">
            <button type="button" class="action-button" onclick="generatePdf()">Gerar e Baixar PDF</button>
        </div>

        <p id="successMessage">PDF gerado e baixado com sucesso!</p>

        <div class="instructions-box">
            <h4>Instruções Detalhadas para Salvar o PDF:</h4>
            <ol>
                <li>Preencha cuidadosamente todo o formulário com as informações solicitadas.</li>
                <li>Clique no botão "Gerar e Baixar PDF".</li>
                <li>Um arquivo PDF com suas respostas será automaticamente baixado.</li>
                <li>Aguarde o download ser concluído.</li>
            </ol>
        </div>
    </div>

    <script>
        function generatePdf() {
            const nomeCliente = document.getElementById('nome_completo').value || 'Cliente';
            
            // Criar estrutura limpa para PDF
            const pdfContainer = document.createElement('div');
            pdfContainer.className = 'pdf-container';
            
            // Título
            const titulo = document.createElement('div');
            titulo.className = 'pdf-title';
            titulo.textContent = 'Questionário para Análise de Ação Trabalhista';
            pdfContainer.appendChild(titulo);

            // Definir todas as perguntas e campos
            const perguntas = [
                { secao: 'I. Dados Pessoais e Contrato de Trabalho', campos: [
                    { id: 'nome_completo', label: 'Nome completo:' },
                    { id: 'cpf', label: 'CPF:' },
                    { id: 'rg', label: 'RG:' },
                    { id: 'data_nascimento', label: 'Data de Nascimento:' },
                    { id: 'endereco', label: 'Endereço completo:' },
                    { id: 'telefone', label: 'Telefone:' },
                    { id: 'email_cliente', label: 'E-mail:' },
                    { id: 'razao_social', label: 'Nome completo (razão social) da empresa:' },
                    { id: 'cnpj', label: 'CNPJ da empresa:' },
                    { id: 'endereco_empresa', label: 'Endereço completo da empresa:' },
                    { id: 'responsavel_empresa', label: 'Nome do responsável da empresa:' },
                    { id: 'copia_contrato', label: 'Possui cópia do contrato de trabalho:' },
                    { id: 'data_inicio', label: 'Data de início da prestação de serviços:' },
                    { id: 'data_saida', label: 'Data de saída:' },
                    { id: 'cargo_funcao', label: 'Cargo/função registrada no contrato:' },
                    { id: 'salario_inicial', label: 'Salário inicial e últimos salários recebidos:' },
                    { id: 'copia_ctps', label: 'Possui cópia da CTPS:' }
                ]},
                { secao: 'II. Jornada de Trabalho', campos: [
                    { id: 'carga_horaria_contratual', label: 'Carga horária contratual:' },
                    { id: 'jornada_praticada', label: 'Jornada de trabalho diária praticada:' },
                    { id: 'qtd_horas_extras', label: 'Quantidade de horas extras estimada:' },
                    { id: 'registro_ponto', label: 'Empresa mantinha registro de ponto:' },
                    { id: 'pagamento_horas_extras', label: 'Pagamento de horas extras:' },
                    { id: 'duracao_intervalo', label: 'Duração do intervalo para almoço:' },
                    { id: 'dsr', label: 'Descanso Semanal Remunerado e feriados:' }
                ]},
                { secao: 'III. Salário e Verbas Trabalhistas', campos: [
                    { id: 'copia_contracheques', label: 'Possui cópia dos contracheques:' },
                    { id: 'adicionais', label: 'Adicionais recebidos:' },
                    { id: 'desvio_funcao', label: 'Desvio/acúmulo de função:' },
                    { id: 'reajustes_salariais', label: 'Reajustes salariais:' },
                    { id: 'beneficios', label: 'Benefícios oferecidos pela empresa:' },
                    { id: 'fgts', label: 'Depósitos de FGTS:' }
                ]},
                { secao: 'IV. Rescisão Contratual', campos: [
                    { id: 'tipo_rescisao', label: 'Tipo de rescisão:' },
                    { id: 'trct', label: 'Possui cópia do TRCT:' },
                    { id: 'seguro_desemprego', label: 'Empresa forneceu guia do seguro-desemprego:' }
                ]},
                { secao: 'V. Assédio Moral/Perseguição', campos: [
                    { id: 'detalhes_assedio', label: 'Detalhes dos episódios de assédio/perseguição:' },
                    { id: 'provas_assedio', label: 'Provas dos incidentes:' },
                    { id: 'impacto_saude', label: 'Impacto na saúde:' }
                ]},
                { secao: 'VI. Provas e Testemunhas', campos: [
                    { id: 'documentos_gerais', label: 'Documentos gerais adicionais:' },
                    { id: 'testemunhas', label: 'Testemunhas (nomes e contatos):' },
                    { id: 'conversas_prints', label: 'Conversas/prints de WhatsApp, e-mails:' }
                ]},
                { secao: 'VII. Outras Informações Relevantes', campos: [
                    { id: 'situacao_atual_cliente', label: 'Situação atual do cliente:' },
                    { id: 'reclamacoes_anteriores', label: 'Reclamações anteriores à empresa:' },
                    { id: 'conhecimento_empresa', label: 'Conhecimento da empresa sobre irregularidades:' },
                    { id: 'sindicato', label: 'Filiado a sindicato:' }
                ]}
            ];

            // Construir o PDF
            perguntas.forEach(secaoData => {
                const secao = document.createElement('div');
                secao.className = 'pdf-section';
                
                const tituloSecao = document.createElement('h3');
                tituloSecao.textContent = secaoData.secao;
                secao.appendChild(tituloSecao);

                secaoData.campos.forEach(campo => {
                    const input = document.getElementById(campo.id);
                    if (input) {
                        let valor = input.value.trim();
                        
                        // Não usar placeholder se campo estiver vazio
                        if (!valor) {
                            valor = '';
                        }
                        
                        // Converter data para formato brasileiro
                        if (campo.id.includes('data_') && valor.includes('-')) {
                            const partes = valor.split('-');
                            if (partes.length === 3) {
                                valor = `${partes[2]}/${partes[1]}/${partes[0]}`;
                            }
                        }

                        const perguntaDiv = document.createElement('div');
                        perguntaDiv.className = 'pdf-question';

                        const perguntaLabel = document.createElement('div');
                        perguntaLabel.className = 'question';
                        perguntaLabel.textContent = campo.label;
                        perguntaDiv.appendChild(perguntaLabel);

                        const respostaDiv = document.createElement('div');
                        respostaDiv.className = 'answer';
                        respostaDiv.textContent = valor;
                        perguntaDiv.appendChild(respostaDiv);

                        secao.appendChild(perguntaDiv);
                    }
                });

                pdfContainer.appendChild(secao);
            });

            // Adicionar ao DOM temporariamente
            document.body.appendChild(pdfContainer);

            // Configurações do PDF
            const opt = {
                margin: 15,
                filename: `Questionario_Trabalhista_${nomeCliente.replace(/[^a-zA-Z0-9]/g, '_')}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: {
                    scale: 2,
                    logging: false,
                    dpi: 300,
                    letterRendering: true,
                    width: 800,
                    height: pdfContainer.scrollHeight
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait' 
                },
                pagebreak: { 
                    mode: ['avoid-all', 'css'] 
                }
            };

            // Gerar PDF
            html2pdf().set(opt).from(pdfContainer).save().then(() => {
                // Remover elemento temporário
                document.body.removeChild(pdfContainer);
                
                // Mostrar mensagem de sucesso
                document.getElementById('successMessage').style.display = 'block';
            }).catch(error => {
                console.error("Erro ao gerar PDF:", error);
                if (document.body.contains(pdfContainer)) {
                    document.body.removeChild(pdfContainer);
                }
                alert("Erro ao gerar PDF. Tente novamente.");
            });
        }
    </script>
</body>
</html>

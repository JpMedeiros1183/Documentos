<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Documentos Jurídicos</title>
    <style>
        body {
            font-family: 'Times New Roman', Times, serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }
        .form-container {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px;
        }
        .form-col {
            flex: 1 0 200px;
            padding: 0 10px;
            margin-bottom: 15px;
        }
        .form-col-small {
            flex: 0 0 100px;
            padding: 0 10px;
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #444;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-family: inherit;
            font-size: 14px;
        }
        .buttons {
            margin-top: 25px;
            text-align: center;
        }
        button {
            padding: 12px 25px;
            background-color: #003366;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.3s;
            margin: 0 5px;
        }
        button:hover {
            background-color: #00254d;
        }
        #documentosContainer {
            display: none;
            margin-top: 30px;
        }
        .documento-preview {
            background-color: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .documento {
            font-size: 11px;
            line-height: 1.2;
            text-align: justify;
        }
        .documento h2 {
            text-align: center;
            font-size: 11px;
            margin-top: 10px;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .assinatura {
            margin-top: 40px;
            text-align: center;
        }
        .linha {
            display: inline-block;
            width: 80%;
            border-bottom: 1px solid black;
        }
        .data {
            text-align: right;
            margin: 20px 0 15px;
        }
        .timbre {
            text-align: center;
            margin-bottom: 15px;
            font-size: 11px;
            color: #555;
        }
        .required:after {
            content: " *";
            color: red;
        }
        .tipo-pessoa {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            justify-content: center;
        }
        .tipo-pessoa label {
            display: inline-flex;
            align-items: center;
            cursor: pointer;
        }
        .tipo-pessoa input {
            width: auto;
            margin-right: 5px;
        }
        .section-title {
            margin-top: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        #pessoaJuridicaFields {
            display: none;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #eee;
        }
        .header-container {
            text-align: center;
            margin-bottom: 15px;
        }
        .header-title {
            font-size: 14px;
            font-weight: bold;
            color: #003366;
            margin-bottom: 4px;
        }
        .header-subtitle {
            font-size: 11px;
            color: #666;
        }
        .pagamento-section {
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #eee;
        }
        .documento p {
            margin-top: 0.3em;
            margin-bottom: 0.3em;
        }
        .documento ul {
            padding-left: 20px;
            margin: 5px 0;
        }
        .documento ul li {
            margin: 2px 0;
        }
        
        /* Estilos para abas de documentos */
        .doc-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #003366;
        }
        .doc-tab {
            padding: 10px 20px;
            background-color: #e0e0e0;
            border: 1px solid #ccc;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
            cursor: pointer;
            font-weight: bold;
            color: #555;
        }
        .doc-tab.active {
            background-color: #003366;
            color: white;
            border-color: #003366;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        /* Seção para escolha do documento */
        .doc-selection {
            margin: 20px 0;
            padding: 15px;
            background-color: #f0f7ff;
            border-radius: 5px;
            border: 1px solid #d0e5ff;
        }
        .doc-selection h3 {
            margin-top: 0;
            color: #003366;
        }
        .doc-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        .doc-option {
            flex: 1 0 200px;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 15px;
            background-color: white;
            transition: all 0.3s;
        }
        .doc-option:hover {
            border-color: #003366;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .doc-option.selected {
            border-color: #003366;
            background-color: #e6eeff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .doc-option h4 {
            margin: 0 0 10px 0;
            color: #003366;
            display: inline-block;
        }
        .doc-option p {
            font-size: 13px;
            color: #666;
            margin: 5px 0;
        }
        .doc-checkbox-wrapper {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .doc-checkbox {
            margin-right: 10px;
            width: 20px !important;
            height: 20px !important;
            cursor: pointer;
        }
        
        /* Campos específicos para cada documento */
        .documento-fields {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #eee;
        }
        
        /* Botões de ação para os documentos */
        .doc-actions {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }
        
        .doc-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .doc-title h3 {
            margin: 0;
            color: #003366;
        }
        
        .doc-title .doc-buttons {
            display: flex;
            gap: 10px;
        }
        
        .doc-title .doc-buttons button {
            padding: 8px 15px;
            font-size: 14px;
        }
        
        .divider {
            margin: 30px 0;
            border-top: 1px dashed #ccc;
        }

        /* Correções para layout em dispositivos móveis */
        @media screen and (max-width: 767px) {
            .form-container {
                padding: 15px;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .form-col, .form-col-small {
                flex: 1 0 100%;
            }
            
            .tipo-pessoa {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            button {
                padding: 15px 20px;
                margin: 10px 0;
                width: 100%;
            }
            
            .doc-options {
                flex-direction: column;
            }
            
            .doc-option {
                flex: 1 0 100%;
            }
            
            .documento-preview {
                padding: 20px;
            }
            
            .doc-title {
                flex-direction: column;
                gap: 10px;
            }
            
            .doc-title .doc-buttons {
                width: 100%;
            }
            
            .doc-title .doc-buttons button {
                flex: 1;
            }
        }
    </style>
</head>
<body>
    <h1>Gerador de Documentos Jurídicos</h1>
    
    <div class="form-container" id="formulario">
        <div class="doc-selection">
            <h3>Selecione os documentos que deseja gerar:</h3>
            <div class="doc-options">
                <div class="doc-option" id="optContrato">
                    <div class="doc-checkbox-wrapper">
                        <input type="checkbox" class="doc-checkbox" id="checkContrato" onchange="atualizarSelecaoDocumento('contrato')">
                        <h4>Contrato de Honorários</h4>
                    </div>
                    <p>Gera um contrato de honorários advocatícios com detalhes de pagamento e serviços</p>
                </div>
                <div class="doc-option" id="optProcuracao">
                    <div class="doc-checkbox-wrapper">
                        <input type="checkbox" class="doc-checkbox" id="checkProcuracao" onchange="atualizarSelecaoDocumento('procuracao')">
                        <h4>Procuração</h4>
                    </div>
                    <p>Gera uma procuração "ad judicia et extra" para representação legal</p>
                </div>
                <div class="doc-option" id="optHipossuficiencia">
                    <div class="doc-checkbox-wrapper">
                        <input type="checkbox" class="doc-checkbox" id="checkHipossuficiencia" onchange="atualizarSelecaoDocumento('hipossuficiencia')">
                        <h4>Declaração de Hipossuficiência</h4>
                    </div>
                    <p>Gera uma declaração de hipossuficiência para solicitação de justiça gratuita</p>
                </div>
            </div>
        </div>
        
        <div class="tipo-pessoa">
            <label><input type="radio" name="tipoPessoa" value="fisica" checked onchange="togglePessoaJuridica()"> Pessoa Física</label>
            <label><input type="radio" name="tipoPessoa" value="juridica" onchange="togglePessoaJuridica()"> Pessoa Jurídica</label>
        </div>
        
        <div id="pessoaJuridicaFields">
            <h3 class="section-title">Dados da Empresa</h3>
            <div class="form-group">
                <label for="nomeEmpresa" class="required">Razão Social:</label>
                <input type="text" id="nomeEmpresa">
            </div>
            
            <div class="form-group">
                <label for="cnpj" class="required">CNPJ:</label>
                <input type="text" id="cnpj" placeholder="Ex: 00.000.000/0001-00">
            </div>
            
            <div class="form-row">
                <div class="form-col">
                    <label for="tipoLogradouroEmpresa" class="required">Tipo de Logradouro:</label>
                    <select id="tipoLogradouroEmpresa">
                        <option value="Rua">Rua</option>
                        <option value="Avenida">Avenida</option>
                        <option value="Alameda">Alameda</option>
                        <option value="Estrada">Estrada</option>
                        <option value="Praça">Praça</option>
                        <option value="Travessa">Travessa</option>
                        <option value="Rodovia">Rodovia</option>
                    </select>
                </div>
                
                <div class="form-col">
                    <label for="logradouroEmpresa" class="required">Logradouro:</label>
                    <input type="text" id="logradouroEmpresa">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-col-small">
                    <label for="numeroEmpresa" class="required">Número:</label>
                    <input type="text" id="numeroEmpresa">
                </div>
                
                <div class="form-col">
                    <label for="complementoEmpresa">Complemento:</label>
                    <input type="text" id="complementoEmpresa" placeholder="Sala, Andar, etc.">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-col">
                    <label for="bairroEmpresa" class="required">Bairro:</label>
                    <input type="text" id="bairroEmpresa">
                </div>
                
                <div class="form-col">
                    <label for="cidadeEmpresa" class="required">Cidade:</label>
                    <input type="text" id="cidadeEmpresa">
                </div>
                
                <div class="form-col-small">
                    <label for="ufEmpresa" class="required">UF:</label>
                    <select id="ufEmpresa">
                        <option value="AC">AC</option>
                        <option value="AL">AL</option>
                        <option value="AM">AM</option>
                        <option value="AP">AP</option>
                        <option value="BA">BA</option>
                        <option value="CE">CE</option>
                        <option value="DF">DF</option>
                        <option value="ES">ES</option>
                        <option value="GO">GO</option>
                        <option value="MA">MA</option>
                        <option value="MG">MG</option>
                        <option value="MS">MS</option>
                        <option value="MT">MT</option>
                        <option value="PA">PA</option>
                        <option value="PB">PB</option>
                        <option value="PE">PE</option>
                        <option value="PI">PI</option>
                        <option value="PR">PR</option>
                        <option value="RJ">RJ</option>
                        <option value="RN" selected>RN</option>
                        <option value="RO">RO</option>
                        <option value="RR">RR</option>
                        <option value="RS">RS</option>
                        <option value="SC">SC</option>
                        <option value="SE">SE</option>
                        <option value="SP">SP</option>
                        <option value="TO">TO</option>
                    </select>
                </div>
            </div>
            
            <div class="form-group">
                <label for="cepEmpresa" class="required">CEP:</label>
                <input type="text" id="cepEmpresa" placeholder="Ex: 59000-000">
            </div>
        </div>
        
        <h3 class="section-title" id="dadosPessoaisTitle">Dados Pessoais</h3>
        
        <div class="form-group">
            <label for="nome" class="required">Nome completo:</label>
            <input type="text" id="nome" required>
        </div>
        
        <div class="form-row">
            <div class="form-col">
                <label for="nacionalidade" class="required">Nacionalidade:</label>
                <input type="text" id="nacionalidade" value="brasileiro(a)" required>
            </div>
            
            <div class="form-col">
                <label for="estadoCivil" class="required">Estado Civil:</label>
                <select id="estadoCivil" required>
                    <option value="solteiro(a)">Solteiro(a)</option>
                    <option value="casado(a)">Casado(a)</option>
                    <option value="divorciado(a)">Divorciado(a)</option>
                    <option value="viúvo(a)">Viúvo(a)</option>
                    <option value="união estável">União Estável</option>
                </select>
            </div>
        </div>
        
        <div class="form-group">
            <label for="profissao" class="required">Profissão:</label>
            <input type="text" id="profissao" required>
        </div>
        
        <div class="form-row">
            <div class="form-col">
                <label for="rg" class="required">RG:</label>
                <input type="text" id="rg" placeholder="Ex: 1234567 SSP/RN" required>
            </div>
            
            <div class="form-col">
                <label for="cpf" class="required">CPF:</label>
                <input type="text" id="cpf" placeholder="Ex: 123.456.789-00" required>
            </div>
        </div>
        
        <h3 class="section-title" id="enderecoTitle">Endereço</h3>
        
        <div class="form-row">
            <div class="form-col">
                <label for="tipoLogradouro" class="required">Tipo de Logradouro:</label>
                <select id="tipoLogradouro" required>
                    <option value="Rua">Rua</option>
                    <option value="Avenida">Avenida</option>
                    <option value="Alameda">Alameda</option>
                    <option value="Estrada">Estrada</option>
                    <option value="Praça">Praça</option>
                    <option value="Travessa">Travessa</option>
                    <option value="Rodovia">Rodovia</option>
                </select>
            </div>
            
            <div class="form-col">
                <label for="logradouro" class="required">Logradouro:</label>
                <input type="text" id="logradouro" required>
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-col-small">
                <label for="numero" class="required">Número:</label>
                <input type="text" id="numero" required>
            </div>
            
            <div class="form-col">
                <label for="complemento">Complemento:</label>
                <input type="text" id="complemento" placeholder="Apto, Bloco, etc.">
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-col">
                <label for="bairro" class="required">Bairro:</label>
                <input type="text" id="bairro" required>
            </div>
            
            <div class="form-col">
                <label for="cidade" class="required">Cidade:</label>
                <input type="text" id="cidade" required>
            </div>
            
            <div class="form-col-small">
                <label for="uf" class="required">UF:</label>
                <select id="uf" required>
                    <option value="AC">AC</option>
                    <option value="AL">AL</option>
                    <option value="AM">AM</option>
                    <option value="AP">AP</option>
                    <option value="BA">BA</option>
                    <option value="CE">CE</option>
                    <option value="DF">DF</option>
                    <option value="ES">ES</option>
                    <option value="GO">GO</option>
                    <option value="MA">MA</option>
                    <option value="MG">MG</option>
                    <option value="MS">MS</option>
                    <option value="MT">MT</option>
                    <option value="PA">PA</option>
                    <option value="PB">PB</option>
                    <option value="PE">PE</option>
                    <option value="PI">PI</option>
                    <option value="PR">PR</option>
                    <option value="RJ">RJ</option>
                    <option value="RN" selected>RN</option>
                    <option value="RO">RO</option>
                    <option value="RR">RR</option>
                    <option value="RS">RS</option>
                    <option value="SC">SC</option>
                    <option value="SE">SE</option>
                    <option value="SP">SP</option>
                    <option value="TO">TO</option>
                </select>
            </div>
        </div>
        
        <div class="form-group">
            <label for="cep" class="required">CEP:</label>
            <input type="text" id="cep" placeholder="Ex: 59000-000" required>
        </div>
        
        <!-- Campos específicos para o Contrato -->
        <div id="contratoFields" class="documento-fields">
            <h3 class="section-title">Dados do Processo (Contrato de Honorários)</h3>
            <div class="form-group">
                <label for="numeroProcesso" class="required">Número do Processo ou Nome da Parte Adversa:</label>
                <input type="text" id="numeroProcesso">
            </div>
            
            <h3 class="section-title">Condições de Pagamento</h3>
            <div class="form-group">
                <label for="valorTotal" class="required">Valor Total Contratado (R$):</label>
                <input type="text" id="valorTotal" placeholder="Ex: 5000.00">
            </div>
            
            <div class="form-group">
                <label for="entradaDigital">Valor da Entrada (R$):</label>
                <input type="text" id="entradaDigital" placeholder="Ex: 1000.00">
            </div>
            
            <div class="form-row">
                <div class="form-col">
                    <label for="numeroParcelas">Número de Parcelas (máximo 10):</label>
                    <select id="numeroParcelas">
                        <option value="0">Sem parcelamento</option>
                        <option value="1">1 parcela</option>
                        <option value="2">2 parcelas</option>
                        <option value="3">3 parcelas</option>
                        <option value="4">4 parcelas</option>
                        <option value="5">5 parcelas</option>
                        <option value="6">6 parcelas</option>
                        <option value="7">7 parcelas</option>
                        <option value="8">8 parcelas</option>
                        <option value="9">9 parcelas</option>
                        <option value="10">10 parcelas</option>
                    </select>
                </div>
                
                <div class="form-col-small">
                    <label for="diaVencimento">Dia de Vencimento:</label>
                    <input type="number" id="diaVencimento" min="1" max="31" placeholder="Ex: 10">
                </div>
            </div>
            
            <div class="form-group">
                <label for="percentualExito">Percentual sobre Proveito Econômico Final (%):</label>
                <input type="text" id="percentualExito" placeholder="Ex: 20">
            </div>
        </div>
        
        <!-- Campos específicos para Declaração de Hipossuficiência -->
        <div id="hipossuficienciaFields" class="documento-fields">
            <h3 class="section-title">Dados para Declaração de Hipossuficiência</h3>
            
            <div class="form-group">
                <label for="rendaMensal" class="required">Renda Mensal Aproximada (R$):</label>
                <input type="text" id="rendaMensal" placeholder="Ex: 1500.00">
            </div>
            
            <div class="form-group">
                <label for="numeroProcessoHipo">Número do Processo (se já existente):</label>
                <input type="text" id="numeroProcessoHipo" placeholder="Ex: 0000000-00.0000.0.00.0000">
            </div>
            
            <div class="form-group">
                <label for="motivoHipossuficiencia" class="required">Justificativa da Hipossuficiência:</label>
                <textarea id="motivoHipossuficiencia" rows="4" placeholder="Descreva brevemente sua situação econômica..."></textarea>
            </div>
            
            <div class="form-group">
                <label>Documentos que Possui para Comprovar a Hipossuficiência:</label>
                <div>
                    <label style="display: inline-flex; align-items: center; margin-right: 15px; font-weight: normal;">
                        <input type="checkbox" id="docCadUnico" style="width: auto; margin-right: 5px;"> Cadastro Único
                    </label>
                    <label style="display: inline-flex; align-items: center; margin-right: 15px; font-weight: normal;">
                        <input type="checkbox" id="docCTPS" style="width: auto; margin-right: 5px;"> CTPS/Holerite
                    </label>
                    <label style="display: inline-flex; align-items: center; margin-right: 15px; font-weight: normal;">
                        <input type="checkbox" id="docBPC" style="width: auto; margin-right: 5px;"> BPC/LOAS
                    </label>
                    <label style="display: inline-flex; align-items: center; margin-right: 15px; font-weight: normal;">
                        <input type="checkbox" id="docDeclaracao" style="width: auto; margin-right: 5px;"> Declaração de IR
                    </label>
                </div>
            </div>
        </div>
        
        <div class="buttons">
            <button id="btnGerarDocumentos" onclick="gerarTodosDocumentos()">Gerar Documentos</button>
        </div>
    </div>
    
    <div id="documentosContainer">
        <div class="buttons noPrint">
            <button onclick="voltarFormulario()" style="background-color: #666;">Voltar ao Formulário</button>
        </div>
        
        <div id="documentosGerados">
            <!-- Os documentos gerados serão inseridos aqui -->
        </div>
    </div>
    
    <script>
        let documentosSelecionados = [];
        
        function atualizarSelecaoDocumento(tipo) {
            const checkbox = document.getElementById('check' + tipo.charAt(0).toUpperCase() + tipo.slice(1));
            const docOption = document.getElementById('opt' + tipo.charAt(0).toUpperCase() + tipo.slice(1));
            
            if (checkbox.checked) {
                docOption.classList.add('selected');
                if (!documentosSelecionados.includes(tipo)) {
                    documentosSelecionados.push(tipo);
                }
            } else {
                docOption.classList.remove('selected');
                documentosSelecionados = documentosSelecionados.filter(doc => doc !== tipo);
            }
            
            // Mostrar/ocultar campos específicos
            atualizarCamposEspecificos();
            
            // Atualizar texto do botão
            atualizarTextoBotao();
        }
        
        function atualizarCamposEspecificos() {
            // Ocultar todos os campos específicos
            document.querySelectorAll('.documento-fields').forEach(field => {
                field.style.display = 'none';
            });
            
            // Mostrar campos específicos dos documentos selecionados
            if (documentosSelecionados.includes('contrato')) {
                document.getElementById('contratoFields').style.display = 'block';
            }
            
            if (documentosSelecionados.includes('hipossuficiencia')) {
                document.getElementById('hipossuficienciaFields').style.display = 'block';
            }
        }
        
        function atualizarTextoBotao() {
            const btnGerarDocumentos = document.getElementById('btnGerarDocumentos');
            if (documentosSelecionados.length === 0) {
                btnGerarDocumentos.textContent = 'Selecione pelo menos um documento';
                btnGerarDocumentos.disabled = true;
            } else {
                btnGerarDocumentos.textContent = 'Gerar ' + (documentosSelecionados.length === 1 ? 'Documento' : 'Documentos');
                btnGerarDocumentos.disabled = false;
            }
        }
        
        function togglePessoaJuridica() {
            const tipoPessoa = document.querySelector('input[name="tipoPessoa"]:checked').value;
            const pessoaJuridicaFields = document.getElementById('pessoaJuridicaFields');
            
            // Oculta documentos quando alterna entre tipos
            document.getElementById('documentosContainer').style.display = 'none';
            document.getElementById('formulario').style.display = 'block';
            
            if (tipoPessoa === 'juridica') {
                pessoaJuridicaFields.style.display = 'block';
                document.getElementById('dadosPessoaisTitle').textContent = 'Dados do Representante';
                document.getElementById('enderecoTitle').textContent = 'Endereço do Representante';
            } else {
                pessoaJuridicaFields.style.display = 'none';
                document.getElementById('dadosPessoaisTitle').textContent = 'Dados Pessoais';
                document.getElementById('enderecoTitle').textContent = 'Endereço';
            }
        }
        
        function formatarData(data) {
            const dia = data.getDate().toString().padStart(2, '0');
            const mes = data.toLocaleString('pt-BR', { month: 'long' });
            const ano = data.getFullYear();
            return `${dia} de ${mes} de ${ano}`;
        }
        
        function formatarValor(valor) {
            return parseFloat(valor).toLocaleString('pt-BR', {
                style: 'currency',
                currency: 'BRL',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }
        
        function parseMoeda(valor) {
            // Remove pontos e substitui vírgula por ponto para converter para float
            if (!valor) return 0;
            return parseFloat(valor.replace(/\./g, '').replace(',', '.'));
        }
        
        function calcularValorParcela(valorTotal, entrada, numParcelas) {
            if (numParcelas <= 0) return 0;
            
            const valorEntrada = entrada ? parseMoeda(entrada) : 0;
            const valorParcelar = parseMoeda(valorTotal) - valorEntrada;
            
            return valorParcelar / parseInt(numParcelas);
        }
        
        function voltarFormulario() {
            document.getElementById('documentosContainer').style.display = 'none';
            document.getElementById('formulario').style.display = 'block';
            document.getElementById('formulario').scrollIntoView({ behavior: 'smooth' });
        }
        
        function gerarTodosDocumentos() {
            if (documentosSelecionados.length === 0) {
                alert('Por favor, selecione pelo menos um documento para gerar.');
                return;
            }
            
            // Limpar container de documentos
            document.getElementById('documentosGerados').innerHTML = '';
            
            // Verificar campos obrigatórios comuns
            if (!verificarCamposObrigatoriosComuns()) {
                return; // Este return é crucial para parar a execução se campos obrigatórios estiverem faltando
            }
            
            // Gerar cada documento selecionado - ORDEM MODIFICADA
            // Gerar primeiro a procuração e a declaração, depois o contrato
            let todosDocumentosValidos = true;
            
            // Primeiro gerar procuração e hipossuficiência (documentos menores)
            if (documentosSelecionados.includes('procuracao')) {
                gerarProcuracao();
            }
            
            if (documentosSelecionados.includes('hipossuficiencia')) {
                if (!verificarCamposHipossuficiencia()) {
                    todosDocumentosValidos = false;
                } else {
                    gerarDeclaracaoHipossuficiencia();
                }
            }
            
            // Por último, gerar o contrato (documento maior)
            if (documentosSelecionados.includes('contrato') && todosDocumentosValidos) {
                if (!verificarCamposContrato()) {
                    todosDocumentosValidos = false;
                } else {
                    gerarContrato();
                }
            }
            
            if (todosDocumentosValidos) {
                // Exibir os documentos gerados
                document.getElementById('documentosContainer').style.display = 'block';
                document.getElementById('formulario').style.display = 'none';
                document.getElementById('documentosContainer').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function verificarCamposObrigatoriosComuns() {
            const tipoPessoa = document.querySelector('input[name="tipoPessoa"]:checked').value;
            
            // Verificar campos obrigatórios básicos
            const camposBasicos = [
                { id: 'nome', label: 'Nome completo' },
                { id: 'nacionalidade', label: 'Nacionalidade' },
                { id: 'profissao', label: 'Profissão' },
                { id: 'rg', label: 'RG' },
                { id: 'cpf', label: 'CPF' },
                { id: 'logradouro', label: 'Logradouro' },
                { id: 'numero', label: 'Número' },
                { id: 'bairro', label: 'Bairro' },
                { id: 'cidade', label: 'Cidade' },
                { id: 'cep', label: 'CEP' }
            ];
            
            let camposFaltantes = [];
            
            for (const campo of camposBasicos) {
                const elemento = document.getElementById(campo.id);
                if (!elemento || !elemento.value.trim()) {
                    camposFaltantes.push(campo.label);
                }
            }
            
            if (tipoPessoa === 'juridica') {
                const camposEmpresa = [
                    { id: 'nomeEmpresa', label: 'Razão Social' },
                    { id: 'cnpj', label: 'CNPJ' },
                    { id: 'logradouroEmpresa', label: 'Logradouro da Empresa' },
                    { id: 'numeroEmpresa', label: 'Número da Empresa' },
                    { id: 'bairroEmpresa', label: 'Bairro da Empresa' },
                    { id: 'cidadeEmpresa', label: 'Cidade da Empresa' },
                    { id: 'cepEmpresa', label: 'CEP da Empresa' }
                ];
                
                for (const campo of camposEmpresa) {
                    const elemento = document.getElementById(campo.id);
                    if (!elemento || !elemento.value.trim()) {
                        camposFaltantes.push(campo.label);
                    }
                }
            }
            
            if (camposFaltantes.length > 0) {
                alert('Por favor, preencha os seguintes campos obrigatórios:\n- ' + camposFaltantes.join('\n- '));
                return false;
            }
            
            return true;
        }

        function verificarCamposContrato() {
            const camposContrato = [
                { id: 'numeroProcesso', label: 'Número do Processo/Nome da Parte Adversa' },
                { id: 'valorTotal', label: 'Valor Total Contratado' }
            ];
            
            let camposFaltantes = [];
            
            for (const campo of camposContrato) {
                const elemento = document.getElementById(campo.id);
                if (!elemento || !elemento.value.trim()) {
                    camposFaltantes.push(campo.label);
                }
            }
            
            if (camposFaltantes.length > 0) {
                alert('Para gerar o Contrato, preencha os seguintes campos:\n- ' + camposFaltantes.join('\n- '));
                return false;
            }
            
            return true;
        }

        function verificarCamposHipossuficiencia() {
            const camposHipo = [
                { id: 'rendaMensal', label: 'Renda Mensal Aproximada' },
                { id: 'motivoHipossuficiencia', label: 'Justificativa da Hipossuficiência' }
            ];
            
            let camposFaltantes = [];
            
            for (const campo of camposHipo) {
                const elemento = document.getElementById(campo.id);
                if (!elemento || !elemento.value.trim()) {
                    camposFaltantes.push(campo.label);
                }
            }
            
            if (camposFaltantes.length > 0) {
                alert('Para gerar a Declaração de Hipossuficiência, preencha os seguintes campos:\n- ' + camposFaltantes.join('\n- '));
                return false;
            }
            
            return true;
        }
        
        function gerarContrato() {
            // Verificar tipo de pessoa
            const tipoPessoa = document.querySelector('input[name="tipoPessoa"]:checked').value;
            
            // Obter valores dos campos do contratante
            const nome = document.getElementById('nome').value;
            const nacionalidade = document.getElementById('nacionalidade').value;
            const estadoCivil = document.getElementById('estadoCivil').value;
            const profissao = document.getElementById('profissao').value;
            const rg = document.getElementById('rg').value;
            const cpf = document.getElementById('cpf').value;
            
            // Obter valores do endereço
            const tipoLogradouro = document.getElementById('tipoLogradouro').value;
            const logradouro = document.getElementById('logradouro').value;
            const numero = document.getElementById('numero').value;
            const complemento = document.getElementById('complemento').value;
            const bairro = document.getElementById('bairro').value;
            const cidade = document.getElementById('cidade').value;
            const uf = document.getElementById('uf').value;
            const cep = document.getElementById('cep').value;
            
            // Obter valores do processo e pagamento
            const numeroProcesso = document.getElementById('numeroProcesso').value;
            const valorTotal = document.getElementById('valorTotal').value;
            const entradaDigital = document.getElementById('entradaDigital').value;
            const numeroParcelas = document.getElementById('numeroParcelas').value;
            const diaVencimento = document.getElementById('diaVencimento').value;
            const percentualExito = document.getElementById('percentualExito').value;
            
            // Montar o endereço completo
            let enderecoCompleto = `${tipoLogradouro} ${logradouro}, ${numero}`;
            if (complemento) {
                enderecoCompleto += `, ${complemento}`;
            }
            enderecoCompleto += `, ${bairro}, ${cidade}/${uf}, CEP: ${cep}`;
            
            // Dados da empresa se for pessoa jurídica
            let dadosEmpresa = {};
            let enderecoEmpresa = "";
            
            if (tipoPessoa === 'juridica') {
                const nomeEmpresa = document.getElementById('nomeEmpresa').value;
                const cnpj = document.getElementById('cnpj').value;
                
                // Dados do endereço da empresa
                const tipoLogradouroEmpresa = document.getElementById('tipoLogradouroEmpresa').value;
                const logradouroEmpresa = document.getElementById('logradouroEmpresa').value;
                const numeroEmpresa = document.getElementById('numeroEmpresa').value;
                const complementoEmpresa = document.getElementById('complementoEmpresa').value;
                const bairroEmpresa = document.getElementById('bairroEmpresa').value;
                const cidadeEmpresa = document.getElementById('cidadeEmpresa').value;
                const ufEmpresa = document.getElementById('ufEmpresa').value;
                const cepEmpresa = document.getElementById('cepEmpresa').value;
                
                // Montar endereço da empresa
                enderecoEmpresa = `${tipoLogradouroEmpresa} ${logradouroEmpresa}, ${numeroEmpresa}`;
                if (complementoEmpresa) {
                    enderecoEmpresa += `, ${complementoEmpresa}`;
                }
                enderecoEmpresa += `, ${bairroEmpresa}, ${cidadeEmpresa}/${ufEmpresa}, CEP: ${cepEmpresa}`;
                
                // Salvar dados da empresa
                dadosEmpresa = {
                    nome: nomeEmpresa,
                    cnpj: cnpj,
                    endereco: enderecoEmpresa
                };
            }
            
            // Calcular valores para o contrato
            const valorTotalFormatado = formatarValor(parseMoeda(valorTotal));
            let textoEntrada = "";
            let textoParcelamento = "";
            
            if (entradaDigital && parseMoeda(entradaDigital) > 0) {
                textoEntrada = `Entrada no valor de ${formatarValor(parseMoeda(entradaDigital))}, a ser paga no ato da assinatura deste contrato.`;
            }

            if (numeroParcelas && parseInt(numeroParcelas) > 0) {
                const valorParcela = calcularValorParcela(valorTotal, entradaDigital, numeroParcelas);
                textoParcelamento = `${numeroParcelas} parcela(s) no valor de ${formatarValor(valorParcela)} cada, com vencimento todo dia ${diaVencimento || '05'} de cada mês.`;
            }
            
            let textoPercentual = "";
            if (percentualExito && parseFloat(percentualExito) > 0) {
                textoPercentual = `Adicionalmente, será devido o percentual de ${percentualExito}% (${percentualExito} por cento) sobre o proveito econômico final obtido no processo, a ser pago em até 5 (cinco) dias úteis após o recebimento pelo CONTRATANTE.`;
            }

            // Data atual formatada
            const dataAtual = formatarData(new Date());
            
            // Criar o texto do contrato com cabeçalho do escritório
            let contrato = `
                <div class="documento-preview" id="contrato-documento">
                    <div class="doc-title noPrint">
                        <h3>Contrato de Honorários Advocatícios</h3>
                        <div class="doc-buttons">
                            <button onclick="imprimirDocumentoEspecifico('contrato-documento')">Imprimir Contrato</button>
                        </div>
                    </div>
                    <div class="documento">
                        <div class="header-container">
                            <div class="header-title">MEDEIROS E ALBUQUERQUE ADVOCACIA</div>
                            <div class="header-subtitle">www.medeirosealbuquerqueadv.com.br</div>
                        </div>
                        
                        <h2>CONTRATO DE HONORÁRIOS ADVOCATÍCIOS</h2>
            `;
            
            // Texto específico para pessoa física ou jurídica
            if (tipoPessoa === 'fisica') {
                contrato += `
                    <p>CONTRATANTE: <strong>${nome}</strong>, ${nacionalidade}, ${estadoCivil}, ${profissao}, portador(a) do RG nº ${rg}, inscrito(a) no CPF sob o nº ${cpf}, residente e domiciliado(a) em ${enderecoCompleto}.</p>
                `;
            } else {
                contrato += `
                    <p>CONTRATANTE: <strong>${dadosEmpresa.nome}</strong>, pessoa jurídica de direito privado, inscrita no CNPJ sob o nº ${dadosEmpresa.cnpj}, com sede em ${dadosEmpresa.endereco}, representado(a) neste ato pelo Sócio/Administrador <strong>${nome}</strong>, ${nacionalidade}, ${estadoCivil}, ${profissao}, portador(a) do RG nº ${rg}, inscrito(a) no CPF sob o nº ${cpf}, residente e domiciliado(a) em ${enderecoCompleto}.</p>
                `;
            } 
            
            contrato += `
            <p>CONTRATADO: <strong>JOÃO PAULO SILVA DE MEDEIROS</strong>, OAB/RN 15.441</p>
            
            <h2>DO OBJETO DO CONTRATO</h2>
            <p><strong>Cláusula 1ª.</strong> Prestação de serviços advocatícios no processo nº/Requrido ${numeroProcesso}.</p>
            
            <h2>DOS DEVERES E OBRIGAÇÕES DO CONTRATADO</h2>
            <p><strong>Cláusula 2ª.</strong> Atuar com zelo e profissionalismo, utilizando todos os meios legais.</p>
            <p><strong>Cláusula 3ª.</strong> Informar o Contratante sobre o andamento do processo e solicitar documentos necessários.</p>
            <p><strong>Cláusula 4ª.</strong> Cumprir as normas éticas da OAB.</p>
            
            <h2>DOS DEVERES E OBRIGAÇÕES DO CONTRATANTE</h2>
            <p><strong>Cláusula 5ª.</strong> Fornecer documentos e informações solicitadas.</p>
            <p><strong>Cláusula 6ª.</strong> Comparecer a atos processuais e compromissos agendados.</p>
            
            <h2>DOS HONORÁRIOS ADVOCATÍCIOS</h2>
            <p><strong>Cláusula 7ª.</strong> Total: ${valorTotalFormatado}, a serem pagos:</p>`;
            
            // Adicionar itens de pagamento apenas se existirem
            let itensPagamento = [];
            if (textoEntrada) itensPagamento.push(textoEntrada);
            if (textoParcelamento) itensPagamento.push(textoParcelamento);
            if (textoPercentual) itensPagamento.push(textoPercentual);
            
            if (itensPagamento.length > 0) {
                contrato += `<ul>`;
                itensPagamento.forEach(item => {
                    contrato += `<li>${item}</li>`;
                });
                contrato += `</ul>`;
            }
            
            contrato += `
            <p><strong>Cláusula 8ª.</strong> Dados bancários:</p>
            <p>Banco: INTER (077), Agência: 0001, Conta: 28556993-7, Titular: JOAO PAULO SILVA DE MEDEIROS SOCIEDADE INDIVIDUAL DE ADVOCACIA, CNPJ/PIX: 50.305.249/0001-83</p>
            <p><strong>Cláusula 9ª.</strong> Multa por atraso: 2% + 1% ao mês (pro rata die).</p>
            
            <h2>DA RESCISÃO DO CONTRATO</h2>
            <p><strong>Cláusula 10ª.</strong> Rescisão com notificação prévia de 10 dias:</p>
            <p>Contratante: Pagamento integral dos honorários.</p>
            <p>Contratado: Honorários proporcionais aos serviços prestados.</p>
            
            <div class="data">Natal/RN, ${dataAtual}.</div>
            
            <div class="assinatura">
            <span class="linha">__________________________________</span><br>
            <strong>${nome}</strong><br>
            <span>CONTRATANTE</span>
            </div>
                    </div>
                </div>
            `;
            
            // Adicionar o contrato ao container de documentos
            document.getElementById('documentosGerados').innerHTML += contrato;
        }
        
        function gerarProcuracao() {
            // Verificar tipo de pessoa
            const tipoPessoa = document.querySelector('input[name="tipoPessoa"]:checked').value;
            
            // Obter valores dos campos
            const nome = document.getElementById('nome').value;
            const nacionalidade = document.getElementById('nacionalidade').value;
            const estadoCivil = document.getElementById('estadoCivil').value;
            const profissao = document.getElementById('profissao').value;
            const rg = document.getElementById('rg').value;
            const cpf = document.getElementById('cpf').value;
            
            // Obter valores do endereço
            const tipoLogradouro = document.getElementById('tipoLogradouro').value;
            const logradouro = document.getElementById('logradouro').value;
            const numero = document.getElementById('numero').value;
            const complemento = document.getElementById('complemento').value;
            const bairro = document.getElementById('bairro').value;
            const cidade = document.getElementById('cidade').value;
            const uf = document.getElementById('uf').value;
            const cep = document.getElementById('cep').value;
            
            // Montar o endereço completo
            let enderecoCompleto = `${tipoLogradouro} ${logradouro}, ${numero}`;
            if (complemento) {
                enderecoCompleto += `, ${complemento}`;
            }
            enderecoCompleto += `, ${bairro}, ${cidade}/${uf}, CEP: ${cep}`;
            
            // Dados da empresa se for pessoa jurídica
            let dadosEmpresa = {};
            let enderecoEmpresa = "";
            
            if (tipoPessoa === 'juridica') {
                const nomeEmpresa = document.getElementById('nomeEmpresa').value;
                const cnpj = document.getElementById('cnpj').value;
                
                // Dados do endereço da empresa
                const tipoLogradouroEmpresa = document.getElementById('tipoLogradouroEmpresa').value;
                const logradouroEmpresa = document.getElementById('logradouroEmpresa').value;
                const numeroEmpresa = document.getElementById('numeroEmpresa').value;
                const complementoEmpresa = document.getElementById('complementoEmpresa').value;
                const bairroEmpresa = document.getElementById('bairroEmpresa').value;
                const cidadeEmpresa = document.getElementById('cidadeEmpresa').value;
                const ufEmpresa = document.getElementById('ufEmpresa').value;
                const cepEmpresa = document.getElementById('cepEmpresa').value;
                
                // Montar endereço da empresa
                enderecoEmpresa = `${tipoLogradouroEmpresa} ${logradouroEmpresa}, ${numeroEmpresa}`;
                if (complementoEmpresa) {
                    enderecoEmpresa += `, ${complementoEmpresa}`;
                }
                enderecoEmpresa += `, ${bairroEmpresa}, ${cidadeEmpresa}/${ufEmpresa}, CEP: ${cepEmpresa}`;
                
                // Salvar dados da empresa
                dadosEmpresa = {
                    nome: nomeEmpresa,
                    cnpj: cnpj,
                    endereco: enderecoEmpresa
                };
            }
            
            // Data atual formatada
            const dataAtual = formatarData(new Date());
            
            // Criar o texto da procuração
            let procuracao = `
                <div class="documento-preview" id="procuracao-documento">
                    <div class="doc-title noPrint">
                        <h3>Procuração Judicial</h3>
                        <div class="doc-buttons">
                            <button onclick="imprimirDocumentoEspecifico('procuracao-documento')">Imprimir Procuração</button>
                        </div>
                    </div>
                    <div class="documento">
                        <div class="header-container">
                            <div class="header-title">MEDEIROS E ALBUQUERQUE ADVOCACIA</div>
                            <div class="header-subtitle">www.medeirosealbuquerqueadv.com.br</div>
                        </div>
                        
                        <div class="timbre">INSTRUMENTO PARTICULAR DE PROCURAÇÃO</div>
                        
                        <h2>PROCURAÇÃO "AD JUDICIA ET EXTRA"</h2>
            `;
            
            // Texto específico para pessoa física ou jurídica
            if (tipoPessoa === 'fisica') {
                procuracao += `
                    <p>OUTORGANTE: <strong>${nome}</strong>, ${nacionalidade}, ${estadoCivil}, ${profissao}, portador(a) do RG nº ${rg}, inscrito(a) no CPF sob o nº ${cpf}, residente e domiciliado(a) em ${enderecoCompleto}.</p>
                `;
            } else {
                procuracao += `
                    <p>OUTORGANTE: <strong>${dadosEmpresa.nome}</strong>, pessoa jurídica de direito privado, inscrita no CNPJ sob o nº ${dadosEmpresa.cnpj}, com sede em ${dadosEmpresa.endereco}, representado(a) neste ato pelo Sócio/Administrador <strong>${nome}</strong>, ${nacionalidade}, ${estadoCivil}, ${profissao}, portador(a) do RG nº ${rg}, inscrito(a) no CPF sob o nº ${cpf}, residente e domiciliado(a) em ${enderecoCompleto}.</p>
                `;
            }
            
            // Resto da procuração (comum para os dois tipos)
            procuracao += `
                <p>OUTORGADOS:</p>
                <p>1. <strong>JOÃO PAULO S. MEDEIROS</strong>, advogado, inscrito na Ordem dos Advogados do Brasil, Seccional do Rio Grande do Norte, sob o nº 15.441.</p>
                <p>2. <strong>ALANE MEDEIROS DE ALBUQUERQUE</strong>, advogada, inscrita na Ordem dos Advogados do Brasil, Seccional do Rio Grande do Norte, sob o nº 14.994.</p>
                
                <p>Por este instrumento particular de procuração, o(a) outorgante acima qualificado(a) nomeia e constitui como seus bastantes procuradores os outorgados acima mencionados, a quem confere amplos poderes para o foro em geral, com a cláusula "ad judicia et extra", em qualquer Juízo, Instância ou Tribunal, podendo propor contra quem de direito as ações competentes e defendê-lo(a) nas contrárias, seguindo umas e outras, até final decisão, usando os recursos legais e acompanhando-os, conferindo-lhes, ainda, poderes especiais para:</p>
                
                <p>Confessar, desistir, transigir, firmar compromissos ou acordos, receber e dar quitação, levantar FGTS e seguro desemprego, receber e dar quitação, levantar alvarás judiciais, agindo em conjunto ou separadamente, podendo ainda substabelecer esta em outrem, com ou sem reservas de iguais poderes, dando tudo por bom, firme e valioso, especialmente para representação em processo judicial.</p>
                
                <div class="data">
                    ${cidade}/${uf}, ${dataAtual}.
                </div>
                
                <div class="assinatura">
                    <span class="linha"></span>
                    <p>${nome}<br>CPF: ${cpf}</p>
                </div>
                    </div>
                </div>
            `;
            
            // Adicionar a procuração ao container de documentos
            document.getElementById('documentosGerados').innerHTML += procuracao;
        }
        
        function gerarDeclaracaoHipossuficiencia() {
            // Verificar tipo de pessoa
            const tipoPessoa = document.querySelector('input[name="tipoPessoa"]:checked').value;
            
            // Obter valores dos campos do declarante
            const nome = document.getElementById('nome').value;
            const nacionalidade = document.getElementById('nacionalidade').value;
            const estadoCivil = document.getElementById('estadoCivil').value;
            const profissao = document.getElementById('profissao').value;
            const rg = document.getElementById('rg').value;
            const cpf = document.getElementById('cpf').value;
            
            // Obter valores do endereço
            const tipoLogradouro = document.getElementById('tipoLogradouro').value;
            const logradouro = document.getElementById('logradouro').value;
            const numero = document.getElementById('numero').value;
            const complemento = document.getElementById('complemento').value;
            const bairro = document.getElementById('bairro').value;
            const cidade = document.getElementById('cidade').value;
            const uf = document.getElementById('uf').value;
            const cep = document.getElementById('cep').value;
            
            // Obter valores específicos da declaração
            const rendaMensal = document.getElementById('rendaMensal').value;
            const numeroProcessoHipo = document.getElementById('numeroProcessoHipo').value;
            const motivoHipossuficiencia = document.getElementById('motivoHipossuficiencia').value;
            
            // Verificar os documentos selecionados
            const docCadUnico = document.getElementById('docCadUnico').checked;
            const docCTPS = document.getElementById('docCTPS').checked;
            const docBPC = document.getElementById('docBPC').checked;
            const docDeclaracao = document.getElementById('docDeclaracao').checked;
            
            // Montar o endereço completo
            let enderecoCompleto = `${tipoLogradouro} ${logradouro}, ${numero}`;
            if (complemento) {
                enderecoCompleto += `, ${complemento}`;
            }
            enderecoCompleto += `, ${bairro}, ${cidade}/${uf}, CEP: ${cep}`;
            
            // Dados da empresa se for pessoa jurídica
            let dadosEmpresa = {};
            let enderecoEmpresa = "";
            
            if (tipoPessoa === 'juridica') {
                const nomeEmpresa = document.getElementById('nomeEmpresa').value;
                const cnpj = document.getElementById('cnpj').value;
                
                // Dados do endereço da empresa
                const tipoLogradouroEmpresa = document.getElementById('tipoLogradouroEmpresa').value;
                const logradouroEmpresa = document.getElementById('logradouroEmpresa').value;
                const numeroEmpresa = document.getElementById('numeroEmpresa').value;
                const complementoEmpresa = document.getElementById('complementoEmpresa').value;
                const bairroEmpresa = document.getElementById('bairroEmpresa').value;
                const cidadeEmpresa = document.getElementById('cidadeEmpresa').value;
                const ufEmpresa = document.getElementById('ufEmpresa').value;
                const cepEmpresa = document.getElementById('cepEmpresa').value;
                
                // Montar endereço da empresa
                enderecoEmpresa = `${tipoLogradouroEmpresa} ${logradouroEmpresa}, ${numeroEmpresa}`;
                if (complementoEmpresa) {
                    enderecoEmpresa += `, ${complementoEmpresa}`;
                }
                enderecoEmpresa += `, ${bairroEmpresa}, ${cidadeEmpresa}/${ufEmpresa}, CEP: ${cepEmpresa}`;
                
                // Salvar dados da empresa
                dadosEmpresa = {
                    nome: nomeEmpresa,
                    cnpj: cnpj,
                    endereco: enderecoEmpresa
                };
            }
            
            // Data atual formatada
            const dataAtual = formatarData(new Date());
            
            // Formatar valor da renda mensal
            const rendaMensalFormatada = formatarValor(parseMoeda(rendaMensal));
            
            // Criar lista de documentos comprobatórios
            let listaDocumentos = [];
            if (docCadUnico) listaDocumentos.push("Cadastro Único para Programas Sociais do Governo Federal");
            if (docCTPS) listaDocumentos.push("Carteira de Trabalho e Previdência Social/Holerite");
            if (docBPC) listaDocumentos.push("Comprovante de recebimento do Benefício de Prestação Continuada (BPC/LOAS)");
            if (docDeclaracao) listaDocumentos.push("Declaração de Imposto de Renda");
            
            let textoDocumentos = "";
            if (listaDocumentos.length > 0) {
                textoDocumentos = "<p>Para comprovar a situação acima declarada, junto a esta declaração os seguintes documentos:</p><ul>";
                listaDocumentos.forEach(doc => {
                    textoDocumentos += `<li>${doc}</li>`;
                });
                textoDocumentos += "</ul>";
            }
            
            // Criar o texto da declaração
            let declaracao = `
                <div class="documento-preview" id="hipossuficiencia-documento">
                    <div class="doc-title noPrint">
                        <h3>Declaração de Hipossuficiência</h3>
                        <div class="doc-buttons">
                            <button onclick="imprimirDocumentoEspecifico('hipossuficiencia-documento')">Imprimir Declaração</button>
                        </div>
                    </div>
                    <div class="documento">
                        <div class="header-container">
                            <div class="header-title">MEDEIROS E ALBUQUERQUE ADVOCACIA</div>
                            <div class="header-subtitle">www.medeirosealbuquerqueadv.com.br</div>
                        </div>
                        
                        <h2>DECLARAÇÃO DE HIPOSSUFICIÊNCIA FINANCEIRA</h2>
            `;
            
            // Texto específico para pessoa física ou jurídica
            if (tipoPessoa === 'fisica') {
                declaracao += `
                    <p>Eu, <strong>${nome}</strong>, ${nacionalidade}, ${estadoCivil}, ${profissao}, portador(a) do RG nº ${rg}, inscrito(a) no CPF sob o nº ${cpf}, residente e domiciliado(a) em ${enderecoCompleto}, DECLARO, sob as penas da lei, para fins de comprovação junto ao Poder Judiciário, que sou hipossuficiente financeiramente, sendo impossibilitado(a) de arcar com as despesas processuais e os honorários advocatícios sem prejuízo do sustento próprio e de minha família.</p>
                `;
            } else {
                declaracao += `
                    <p>A empresa <strong>${dadosEmpresa.nome}</strong>, pessoa jurídica de direito privado, inscrita no CNPJ sob o nº ${dadosEmpresa.cnpj}, com sede em ${dadosEmpresa.endereco}, representada neste ato por <strong>${nome}</strong>, ${nacionalidade}, ${estadoCivil}, ${profissao}, portador(a) do RG nº ${rg}, inscrito(a) no CPF sob o nº ${cpf}, residente e domiciliado(a) em ${enderecoCompleto}, DECLARA, sob as penas da lei, para fins de comprovação junto ao Poder Judiciário, que é hipossuficiente financeiramente, sendo impossibilitada de arcar com as despesas processuais e os honorários advocatícios sem prejuízo de sua atividade.</p>
                `;
            }
            
            // Informações sobre renda e processo
            declaracao += `
                <p>Declaro que possuo renda mensal aproximada de ${rendaMensalFormatada}.</p>
                
                <p>Informo ainda que a minha situação econômico-financeira não me permite pagar as custas do processo e os honorários de advogado, sem prejuízo do sustento próprio ou da família, pelos seguintes motivos:</p>
                
                <p>${motivoHipossuficiencia}</p>
            `;
            
            // Adicionar informação do processo se existir
            if (numeroProcessoHipo) {
                declaracao += `<p>Esta declaração é feita para fins de instrução do processo nº ${numeroProcessoHipo}.</p>`;
            }
            
            // Adicionar lista de documentos comprobatórios
            declaracao += textoDocumentos;
            
            // Adicionar declaração ciente das penas
            declaracao += `
                <p>Declaro estar ciente de que a falsidade da presente declaração pode implicar em sanção penal prevista no art. 299 do Código Penal (falsidade ideológica), além de, caso comprovada a não veracidade, ser solicitado o cancelamento da gratuidade, conforme disposto no § 2º do art. 99 do Código de Processo Civil.</p>
                
                <div class="data">
                    ${cidade}/${uf}, ${dataAtual}.
                </div>
                
                <div class="assinatura">
                    <span class="linha"></span>
                    <p>${nome}<br>CPF: ${cpf}</p>
                </div>
                    </div>
                </div>
            `;
            
            // Adicionar a declaração ao container de documentos
            document.getElementById('documentosGerados').innerHTML += declaracao;
        }
        
        // NOVA FUNÇÃO DE IMPRESSÃO QUE CRIA UMA NOVA JANELA
        function imprimirDocumentoEspecifico(docId) {
            // Obter o elemento do documento
            const docElement = document.getElementById(docId);
            
            // Obter apenas o conteúdo que precisa ser impresso (sem os botões)
            const conteudoDoc = docElement.querySelector('.documento').cloneNode(true);
            
            // Determinar o título do documento
            let titulo = "Documento Jurídico";
            if (docId === 'contrato-documento') {
                titulo = "Contrato de Honorários - " + document.getElementById('nome').value;
            } else if (docId === 'procuracao-documento') {
                titulo = "Procuração - " + document.getElementById('nome').value;
            } else if (docId === 'hipossuficiencia-documento') {
                titulo = "Declaração de Hipossuficiência - " + document.getElementById('nome').value;
            }
            
            // Criar uma nova janela
            const printWindow = window.open('', '_blank', 'height=600,width=800');
            
            // Escrever o conteúdo na nova janela
            printWindow.document.write('<html><head><title>' + titulo + '</title>');
            printWindow.document.write('<style>');
            printWindow.document.write(`
                body {
                    font-family: 'Times New Roman', Times, serif;
                    margin: 0;
                    padding: 10px;
                }
                .documento {
                    font-size: 11px;
                    line-height: 1.2;
                    text-align: justify;
                }
                .documento h2 {
                    text-align: center;
                    font-size: 11px;
                    margin-top: 10px;
                    margin-bottom: 8px;
                    font-weight: bold;
                }
                .assinatura {
                    margin-top: 40px;
                    text-align: center;
                }
                .linha {
                    display: inline-block;
                    width: 80%;
                    border-bottom: 1px solid black;
                }
                .data {
                    text-align: right;
                    margin: 20px 0 15px;
                }
                .timbre {
                    text-align: center;
                    margin-bottom: 15px;
                    font-size: 11px;
                    color: #555;
                }
                .documento p {
                    margin-top: 0.3em;
                    margin-bottom: 0.3em;
                }
                .documento ul {
                    padding-left: 20px;
                    margin: 5px 0;
                }
                .documento ul li {
                    margin: 2px 0;
                }
                .header-container {
                    text-align: center;
                    margin-bottom: 15px;
                }
                .header-title {
                    font-size: 14px;
                    font-weight: bold;
                    color: #003366;
                    margin-bottom: 4px;
                }
                .header-subtitle {
                    font-size: 11px;
                    color: #666;
                }
                
                /* Ajuste de tamanho para documentos específicos */
                ${docId === 'procuracao-documento' || docId === 'hipossuficiencia-documento' ? `
                    .documento {
                        font-size: 9px !important;
                        line-height: 1.1 !important;
                    }
                ` : ''}
                
                @media print {
                    body {
                        padding: 0;
                    }
                }
            `);
            printWindow.document.write('</style></head><body>');
            printWindow.document.write(conteudoDoc.outerHTML);
            printWindow.document.write('</body></html>');
            
            // Fechar o stream do documento
            printWindow.document.close();
            
            // Foco na nova janela
            printWindow.focus();
            
            // Chamar a impressão após curto intervalo para garantir carregamento
            setTimeout(function() {
                printWindow.print();
                // Comentado para não fechar a janela automaticamente - deixar o usuário decidir
                // printWindow.close();
            }, 300);
        }

        function imprimirTodosDocumentos() {
            alert("Para evitar problemas de formatação, por favor imprima cada documento individualmente usando os botões 'Imprimir' em cada documento.");
        }
        
        // Adicionar formatação automática para campos numéricos
        document.addEventListener('DOMContentLoaded', function() {
            // Máscara para CPF
            document.getElementById('cpf').addEventListener('input', function() {
                let value = this.value.replace(/\D/g, '');
                if (value.length > 11) value = value.slice(0, 11);
                
                if (value.length > 9) {
                    this.value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
                } else if (value.length > 6) {
                    this.value = value.replace(/(\d{3})(\d{3})(\d{3})/, '$1.$2.$3');
                } else if (value.length > 3) {
                    this.value = value.replace(/(\d{3})(\d{3})/, '$1.$2');
                } else {
                    this.value = value;
                }
            });
            
            // Máscara para CNPJ
            document.getElementById('cnpj').addEventListener('input', function() {
                let value = this.value.replace(/\D/g, '');
                if (value.length > 14) value = value.slice(0, 14);
                
                if (value.length > 12) {
                    this.value = value.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, '$1.$2.$3/$4-$5');
                } else if (value.length > 8) {
                    this.value = value.replace(/(\d{2})(\d{3})(\d{3})(\d{1,4})/, '$1.$2.$3/$4');
                } else if (value.length > 5) {
                    this.value = value.replace(/(\d{2})(\d{3})(\d{1,3})/, '$1.$2.$3');
                } else if (value.length > 2) {
                    this.value = value.replace(/(\d{2})(\d{1,3})/, '$1.$2');
                } else {
                    this.value = value;
                }
            });
            
            // Máscara para CEP
            const mascaraCep = function(input) {
                input.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    if (value.length > 8) value = value.slice(0, 8);
                    
                    if (value.length > 5) {
                        this.value = value.replace(/(\d{5})(\d{1,3})/, '$1-$2');
                    } else {
                        this.value = value;
                    }
                });
            };
            
            mascaraCep(document.getElementById('cep'));
            mascaraCep(document.getElementById('cepEmpresa'));
            
            // Formatação para valores monetários
            const mascaraValor = function(input) {
                input.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    value = (parseInt(value) / 100).toFixed(2) + '';
                    value = value.replace(".", ",");
                    value = value.replace(/(\d)(\d{3})(\,)/g, "$1.$2$3");
                    value = value.replace(/(\d)(\d{3})(\.\d{3})/g, "$1.$2$3");
                    this.value = value;
                });
            };
            
            mascaraValor(document.getElementById('valorTotal'));
            mascaraValor(document.getElementById('entradaDigital'));
            mascaraValor(document.getElementById('rendaMensal'));
            
            // Inicializar exibição/ocultação dos campos de pessoa jurídica
            togglePessoaJuridica();
            
            // Inicializar botão de geração
            atualizarTextoBotao();
        });
    </script>
</body>
</html>
